rules:
- id: generic_os_command_injection
  patterns:
  - pattern-either:
    - pattern-inside: |
        $EXEC = require('child_process');
        ...
    - pattern-inside: |
        import $EXEC from 'child_process';
        ...
    - pattern-inside: |
        $EXEC = require('child_process').exec;
        ...
    - pattern-inside: |
        require('child_process')
        ...
  - pattern-either:
    - pattern: |
        exec(...)
    - pattern: |
        require('child_process').exec(...)
    - pattern: |
        $EXEC.exec
  - pattern-not: |
        exec("...");
  - pattern-not: |
        $EXEC.exec("...");
  - pattern-not: |
        require('child_process').exec("...");
  message: >-
    User controlled data in 'child_process.exec()' can result in Remote OS
    Command Execution.
  languages:
  - javascript
  severity: ERROR
  metadata:
    owasp: 'A1: Injection'
    cwe: >-
      CWE-78: Improper Neutralization of Special Elements used in an OS
      Command ('OS Command Injection')